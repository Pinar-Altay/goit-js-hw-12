{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46322499-d914655ae29712659c6ba744e';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, perPage = 15) { \n  const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(url);\n    return response.data;\n  } catch (error) {\n    console.error('Fetching images failed:', error);\n    throw error; \n  }\n}\n","import { galleryLightbox } from '../main';\n\nexport function createImageCard(image) {\n    return `\n      <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" data-caption=\"${image.tags}\" />\n        <div class=\"info\">\n          <p><b>Likes:</b> ${image.likes}</p>\n          <p><b>Views:</b> ${image.views}</p>\n          <p><b>Comments:</b> ${image.comments}</p>\n          <p><b>Downloads:</b> ${image.downloads}</p>\n        </div>\n      </a>\n    `;\n}\n\nexport function renderGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  const imageCards = images.map(createImageCard).join('');\n  gallery.insertAdjacentHTML('beforeend', imageCards);\n  galleryLightbox.refresh();\n}\n\nexport function clearGallery() {\n  document.querySelector('.gallery').innerHTML = '';\n}","import { fetchImages } from './js/pixabay-api';  \nimport { renderGallery, clearGallery } from './js/render-functions';\nimport './css/styles.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet currentPage = 1;\nconst perPage = 15;\nconst debounceDelay = 300; \nlet debounceTimer;\n\nconst form = document.querySelector('#search-form');\nconst input = form.querySelector('input');\nconst loader = document.querySelector('.loader'); \nconst loadMoreBtn = document.querySelector('.load-btn');\nconst gallery = document.querySelector('.gallery');\n\nexport const galleryLightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'data-caption',\n  captionDelay: 250,\n});\n\nlet query = '';\nlet isEndOfResultsNotificationShown = false; \nlet isLoading = false; \n\n\nform.addEventListener('submit', (e) => {\n  e.preventDefault();\n  clearTimeout(debounceTimer);\n  debounceTimer = setTimeout(() => onSearch(e), debounceDelay);\n});\n\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n    query = input.value.trim();\n  \n    if (!query) {\n      return showNotification('warning', 'Please enter a search query!');\n    }\n  \n    currentPage = 1;\n    clearGallery();\n    resetSearchState();\n  \n    toggleLoader(true);\n    loadMoreBtn.style.display = 'none';\n  \n    await searchImages(query); \n}\n\nasync function searchImages(query) {\n    if (isLoading) return;\n    isLoading = true;\n  \n    try {\n      const data = await fetchImages(query, currentPage, perPage);\n      toggleLoader(false); \n\n      if (data.hits.length === 0) {\n        return showNotification('info', 'Sorry, no images were found for your search query.');\n      }\n  \n      renderGallery(data.hits);\n      galleryLightbox.refresh();\n  \n      handleLoadMoreButton(data.totalHits);\n      scrollToNextPage();\n      input.value = '';\n    } catch (error) {\n      handleSearchError(error);\n    } finally {\n      isLoading = false;\n    }\n}\n\nasync function onLoadMore() {\n    if (isLoading) return;\n\n    loadMoreBtn.classList.add('loading');\n    currentPage += 1; \n    await searchImages(query);\n    loadMoreBtn.classList.remove('loading');\n}\n\nfunction handleLoadMoreButton(totalHits) {\n    const isMoreResults = totalHits > currentPage * perPage;\n    loadMoreBtn.style.display = isMoreResults ? 'block' : 'none';\n\n    if (!isMoreResults && !isEndOfResultsNotificationShown) {\n      showNotification('info', \"We're sorry, but you've reached the end of search results.\");\n      isEndOfResultsNotificationShown = true;\n    }\n}\n\nfunction handleSearchError(error) {\n    toggleLoader(false);\n    showNotification('error', 'Something went wrong. Please try again later.');\n    console.error(error);\n}\n\nfunction toggleLoader(isLoadingFlag) {\n    loader.style.display = isLoadingFlag ? 'flex' : 'none';\n}\n\nfunction showNotification(type, message) {\n  iziToast[type]({\n    title: type.charAt(0).toUpperCase() + type.slice(1),\n    message,\n  });\n}\n\nfunction scrollToNextPage() {\n    const firstCard = gallery.firstElementChild;\n    if (!firstCard) return;\n\n    const { height: cardHeight } = firstCard.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n}\n\nfunction resetSearchState() {\n    isEndOfResultsNotificationShown = false;\n}"],"names":["API_KEY","BASE_URL","fetchImages","query","page","perPage","url","axios","error","createImageCard","image","renderGallery","images","gallery","imageCards","galleryLightbox","clearGallery","currentPage","debounceDelay","debounceTimer","form","input","loader","loadMoreBtn","SimpleLightbox","isEndOfResultsNotificationShown","isLoading","onSearch","onLoadMore","showNotification","resetSearchState","toggleLoader","searchImages","data","handleLoadMoreButton","scrollToNextPage","handleSearchError","totalHits","isMoreResults","isLoadingFlag","type","message","iziToast","firstCard","cardHeight"],"mappings":"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"}